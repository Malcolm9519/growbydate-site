<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>{{ title }}</title>
  <meta name="description" content="{{ description }}" />
  <link rel="canonical" href="{{ canonical }}" />

  <link rel="stylesheet" href="/styles.css" />

  <!-- Google Analytics (production only) -->
  <script>
    (function () {
      // Only track on production domains
      const allowedHosts = ["growbydate.com", "www.growbydate.com"];
      if (!allowedHosts.includes(location.hostname)) return;

      var s = document.createElement("script");
      s.async = true;
      s.src = "https://www.googletagmanager.com/gtag/js?id=G-1B458R6ZB7";
      document.head.appendChild(s);

      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      window.gtag = gtag;

      gtag("js", new Date());
      gtag("config", "G-1B458R6ZB7");
    })();
  </script>

</head>
<body>
  <header class="siteHeader">
    <div class="container siteHeaderInner">
      {% include "nav.njk" %}
    </div>
  </header>

  <main class="container">
    {{ content | safe }}
    {% include "footer.njk" %}
  </main>

  <script>
  (function () {
    const drops = Array.from(document.querySelectorAll("details.navdrop"));
    if (!drops.length) return;

    function closeAll(except) {
      for (const d of drops) {
        if (d !== except) d.removeAttribute("open");
      }
    }

    // When one opens, close the rest
    for (const d of drops) {
      d.addEventListener("toggle", () => {
        if (d.open) closeAll(d);
      });
    }

    // Close on Escape
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        closeAll(null);
      }
    });

    // Click outside closes
    document.addEventListener("click", (e) => {
      const clickedInside = drops.some((d) => d.contains(e.target));
      if (!clickedInside) closeAll(null);
    });
  })();
  </script>
</body>
</html>