
<section class="section">
  <div id="seed-start-planner" class="toolRoot"></div>
</section>


<!-- Structured Data: Tool -->
<script type="application/json" id="siteCropsJson">{{ crops | dump | safe }}</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Seed Starting Planner",
  "applicationCategory": "WebApplication",
  "operatingSystem": "Any",
  "isAccessibleForFree": true,
  "url": "https://growbydate.com/tools/seed-start-planner/",
  "publisher": { "@type": "Organization", "name": "GrowByDate" },
  "description": "A simple seed starting planner that calculates indoor start, hardening off, and outdoor planting windows from your average last frost date‚Äîdesigned for short growing seasons."
}
</script>

<!-- Structured Data: FAQ (keep in sync with the FAQ section below) -->
<style>
  .grid { display: grid; gap: 14px; }

  .row { display: grid; gap: 10px; grid-template-columns: 1fr; }
  @media (min-width: 720px) { .row { grid-template-columns: 1fr 1fr; } }

  /* Prevent grid children from overflowing their column (fixes date input ‚Äúspill‚Äù) */
  .row > div { min-width: 0; }

  label { font-weight: 600; }

  input, select {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid #ccc;
    border-radius: 12px;
    font: inherit;
    box-sizing: border-box;
  }

  /* Extra safety for the frost date field specifically */
  #lastFrost { min-width: 0; max-width: 100%; }

  .small { font-size: 14px; opacity: .85; }
  .card + .card { margin-top: 14px; }

  table { width: 100%; border-collapse: collapse; margin-top: 10px; }
  th, td { padding: 10px 8px; border-bottom: 1px solid #e5e5e5; text-align: left; vertical-align: top; }
  th { font-weight: 700; }

  .pill { display: inline-block; padding: 2px 8px; border: 1px solid #222; border-radius: 999px; font-size: 12px; opacity: .9; }

  .warn { border: 1px solid #e3c46b; border-radius: 12px; padding: 10px 12px; background: #fff8e1; }
 .muted { color: rgba(0, 0, 0, 0.75); }

  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 10px 14px;
    border: 1px solid #111;
    border-radius: 12px;
    background: transparent;
    cursor: pointer;
    font: inherit;
    line-height: 1.2;
    white-space: nowrap;
    box-sizing: border-box;
  }
  .btn:hover { opacity: .85; }

  .btnRow { display:flex; align-items:end; gap:10px; flex-wrap: wrap; }

  /* If your primary action uses .button / .button.primary, normalize it to match .btn */
  .btnRow .button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 10px 14px;
    border-radius: 12px;
    font: inherit;
    line-height: 1.2;
    white-space: nowrap;
    box-sizing: border-box;
  }

  .content { max-width: 760px; }

  .faq details { border: 1px solid #e8e8e8; border-radius: 12px; padding: 10px 12px; background: #fff; }
  .faq details + details { margin-top: 10px; }
  .faq summary { cursor: pointer; font-weight: 650; }

  .breadcrumbs { font-size: 14px; opacity: .85; margin-bottom: 10px; }
  .breadcrumbs a { text-decoration: none; }

  .linkRow { display:flex; gap:10px; flex-wrap: wrap; }
  .linkRow a { text-decoration: none; border-bottom: 1px solid currentColor; }

  .noteIcon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  line-height: 1;
}

#resultsBody svg {
  display: inline-block;
  vertical-align: middle;
  opacity: .85;
}

#resultsBody td.muted {
  opacity: 1;
  color: rgba(0, 0, 0, 0.75);
}

.noteIcon svg {
  display: inline-block;
  vertical-align: middle;
  opacity: .85;
}

/* Keep planner text ‚Äúmuted‚Äù without fading emoji/icons */
#resultsCard .muted,
#resultsCard .small {
  opacity: 1;
}

#resultsCard .muted {
  color: rgba(0, 0, 0, 0.75);
}


/* Print: only print the results card */
@media print {
  /* Hide everything by default */
  body * { visibility: hidden !important; }

  /* Show results */
  #resultsCard, #resultsCard * { visibility: visible !important; }

  /* Position results at top-left for printing */
  #resultsCard {
    position: absolute !important;
    left: 0 !important;
    top: 0 !important;
    width: 100% !important;
    display: block !important;
    box-shadow: none !important;
    border: none !important;
  }

  /* Hide interactive controls inside results */
  #resultsActions { display: none !important; }
}

</style>

<p class="muted">
  Enter your average last frost date and choose a crop. You‚Äôll get a clear window for starting seeds indoors,
  hardening off, and planting outside ‚Äî built for shorter growing seasons where timing matters.
</p>

<section class="card" aria-label="Seed starting planner inputs">
  <div class="grid">
    <div class="row">
      <div>
        <label for="lastFrost">Average last frost date</label>
        <input id="lastFrost" type="date" aria-describedby="lastFrostHelp" />
        <div class="small" id="lastFrostHelp">Example: May 10 (varies by location and year)</div>
      </div>

      <div>
        <label for="crop">Crop</label>
        <select id="crop" aria-describedby="cropHelp"></select>
      </div>
    </div>

    <div class="row">
      <div>
        <label for="protection">Season protection</label>
        <select id="protection" aria-describedby="protectionHelp">
          <option value="0">None (open garden)</option>
          <option value="7">Some protection (row cover / cloche) ‚Äî ~1 week earlier</option>
          <option value="14">More protection (cold frame / tunnel) ‚Äî ~2 weeks earlier</option>
        </select>
        <div class="small" id="protectionHelp">This shifts your outdoor planting window slightly earlier.</div>
      </div>

      <div class="btnRow">
        <button class="button primary" id="calcBtn" type="button">Calculate</button>
        <button class="btn" id="resetBtn" type="button">Reset</button>
        <button class="btn" id="printBtn" type="button" style="display:none;">Print results</button>
      </div>
    </div>
  </div>
</section>

<section class="card" id="resultsCard" style="display:none;">
  <h2>Results</h2>
  <div class="small">
    <span class="pill">Planning tip</span>
    These are ranges. Spring weather can shift timing by a week or more ‚Äî if you‚Äôre unsure, use the later end of each window.
  </div>
  <table>
    <thead>
      <tr>
        <th>Task</th>
        <th>Recommended window</th>
        <th>Notes</th>
      </tr>
    </thead>
    <tbody id="resultsBody"></tbody>
  </table>

  <div class="btnRow" id="resultsActions" style="margin-top:12px;">
    <button class="btn" id="copyBtn" type="button" style="display:none;">Copy plan</button>
    <button class="btn" id="csvBtn" type="button" style="display:none;">Download CSV</button>
    <button class="btn" id="txtBtn" type="button" style="display:none;">Download text</button>
  </div>

</section>
<section class="warn" id="warnBox" style="display:none;"></section>

<section class="card">
  <h2>How this planner works</h2>

  <p class="muted" style="margin-top:0;">
    This tool builds a simple schedule from one anchor: your <strong><a href="/guides/how-to-find-your-last-frost-date/">average last frost date</a></strong>.
    Pick a crop and it will show three windows: <strong>start indoors</strong>, <strong>harden off</strong>, and <strong>move outdoors</strong>.
  </p>

  <div class="row" style="margin-top:10px;">
    <div class="muted">
      <div class="pill">1</div>
      <p style="margin:6px 0 0;"><strong>Enter your last frost date</strong></p>
      <p class="small" style="margin:6px 0 0;">
        Use your ‚Äúaverage‚Äù date to plan. If you‚Äôre unsure, choose the middle of the range you see online.
      </p>
    </div>

    <div class="muted">
      <div class="pill">2</div>
      <p style="margin:6px 0 0;"><strong>Choose a crop</strong></p>
      <p class="small" style="margin:6px 0 0;">
        The planner loads typical timing for that crop (how many weeks before/after frost to start and plant out).
      </p>
    </div>
  </div>

  <div class="row" style="margin-top:10px;">
    <div class="muted">
      <div class="pill">3</div>
      <p style="margin:6px 0 0;"><strong>Click Calculate</strong></p>
      <p class="small" style="margin:6px 0 0;">
        Aim for the <strong>middle</strong> of each range unless you have a reason to shift earlier or later.
      </p>
    </div>

    <div class="muted">
      <div class="pill">4</div>
      <p style="margin:6px 0 0;"><strong>Use the ranges the right way</strong></p>
      <p class="small" style="margin:6px 0 0;">
        <strong>Earlier</strong> = protection / warm microclimate / raised beds.
        <strong>Later</strong> = cold yard / wind / shade / slow spring.
      </p>
    </div>
  </div>

  <p class="small muted" style="margin-top:10px;">
    Quick check: your real ‚Äúgo‚Äù signal is steady nighttime temperatures. Frost dates guide your planning, but your yard decides the final timing.
  </p>
  <p class="muted" style="margin-top:0;">
    <strong>Ready to start planting?</strong> <a href="/guides/seed-starting-supplies-checklist/">Find out for sure with our seed starting checklist.</a>
  </p>
</section>

<section class="card">
  <h2>Short-season notes (what matters most)</h2>
  <div class="muted">
    <p><strong><a href="/guides/seed-starting-short-season/">Start the right crops early.</a></strong> In shorter seasons, warm-season crops usually need an indoor head start.</p>
    <p><strong><a href="/guides/how-to-harden-off-seedlings/">Hardening off is part of the schedule.</a></strong> Even healthy seedlings can stall if they go outside too quickly.</p>
    <p><strong>Protection helps, but it isn‚Äôt magic.</strong> Row covers and tunnels can move planting earlier, but cold soil and cold nights still slow growth.</p>
  </div>
  <p class="small muted">
    This planner is for general guidance and does not replace local extension recommendations.
  </p>
</section>

<section class="card faq" aria-label="Frequently asked questions">
 <h2>FAQ</h2>

<details>
  <summary>Should I use the ‚Äúaverage‚Äù last frost date, or plan for a late frost?</summary>
  <p class="muted">
    Start with the <strong>average last frost date</strong> for a normal baseline. If you regularly get late cold snaps, plan your outdoor move using the
    <em>later end</em> of the outdoor window (and keep protection ready). If you want to be extra cautious, rerun the planner using a later date and compare.
    If you‚Äôre not sure what date to use, see <a href="/guides/how-to-find-your-last-frost-date/">how to find your last frost date</a>.
  </p>
</details>

<details>
  <summary>Why are the results shown as ranges instead of one exact date?</summary>
  <p class="muted">
    ‚ÄúLast frost‚Äù is a probability, and spring weather varies. The early end fits milder springs (or protected setups); the late end fits colder, slower springs.
    Use the range to make decisions you can stick to, not to predict a perfect day.
  </p>
</details>

<details>
  <summary>What if I started seeds already ‚Äî and now the planner says I‚Äôm early?</summary>
  <p class="muted">
    It happens. If seedlings are getting large, the fix is usually more light, cooler nights, and spacing ‚Äî not more time indoors.
    For common symptoms and what to do next, see <a href="/guides/starting-seeds-too-early/">starting seeds too early</a>.
  </p>
</details>

<details>
  <summary>Does ‚Äúseason protection‚Äù mean I can plant out no matter what?</summary>
  <p class="muted">
    Protection helps with light frosts and wind, but cold soil and cold nights still slow growth ‚Äî especially for warm-season crops.
    Use protection to <em>reduce risk</em>, not to ignore conditions. If nights are consistently cold, wait for the safer part of the outdoor range.
  </p>
</details>

<details>
  <summary>How long should I harden off seedlings, and when does it start?</summary>
  <p class="muted">
    Most crops do best with 7‚Äì10 days. Start hardening off near the beginning of the hardening-off window so you can move outdoors during the outdoor window
    without rushing. A simple step-by-step approach is in <a href="/guides/how-to-harden-off-seedlings/">how to harden off seedlings</a>.
  </p>
</details>

<details>
  <summary>Do these dates change for containers, raised beds, or a sheltered spot?</summary>
  <p class="muted">
    Sometimes, slightly. Raised beds and containers can warm faster, while wind exposure can cool plants down. Use the planner‚Äôs ranges, then decide based on
    nighttime temperatures and how fast your soil warms. When you‚Äôre ready to move plants out, follow the checks in
    <a href="/guides/when-to-transplant-seedlings-outdoors/">when to transplant seedlings outdoors</a>.
  </p>
</details>
</section>

<script>
  // ---- Data model ----
  // indoorStartWeeks: [startEarlierWeeks, startLaterWeeks] relative to last frost (before last frost)
  // transplantWeeks:  [earlierWeeks, laterWeeks] relative to last frost (after subtracting protection offset)
  // directSowWeeks:   [earlierWeeks, laterWeeks] relative to last frost (can be negative = before frost date)
  const CROPS = [
    {
      id: "tomato",
      name: "Tomatoes",
      indoorStartWeeks: [8, 6],
      transplantWeeks: [2, 3],
      directSowWeeks: null,
      notes: "Warm-season. Transplant after nights warm up."
    },
    {
      id: "pepper",
      name: "Peppers",
      indoorStartWeeks: [10, 8],
      transplantWeeks: [2, 4],
      directSowWeeks: null,
      notes: "Very warm-season. Needs heat to germinate well."
    },
    {
      id: "cucumber",
      name: "Cucumbers",
      indoorStartWeeks: [4, 3],
      transplantWeeks: [1, 2],
      directSowWeeks: [1, 2],
      notes: "Doesn't love root disturbance; start in larger cells/pots."
    },
    {
      id: "zucchini",
      name: "Zucchini / Summer squash",
      indoorStartWeeks: [4, 3],
      transplantWeeks: [1, 2],
      directSowWeeks: [1, 2],
      notes: "Fast grower. Give it room."
    },
    {
      id: "bean",
      name: "Bush beans",
      indoorStartWeeks: null,
      transplantWeeks: null,
      directSowWeeks: [1, 2],
      notes: "Direct sow when soil warms. Sensitive to frost."
    },
    {
      id: "lettuce",
      name: "Lettuce",
      indoorStartWeeks: [6, 4],
      transplantWeeks: [-2, 0],
      directSowWeeks: [-4, 1],
      notes: "Cool-season. Can handle light frosts."
    },
    {
      id: "spinach",
      name: "Spinach",
      indoorStartWeeks: null,
      transplantWeeks: null,
      directSowWeeks: [-6, -2],
      notes: "Very cold-hardy. Direct sow early."
    },
    {
      id: "kale",
      name: "Kale",
      indoorStartWeeks: [8, 6],
      transplantWeeks: [-2, 1],
      directSowWeeks: [-4, 0],
      notes: "Cold-hardy. Great for short seasons."
    },
    {
      id: "broccoli",
      name: "Broccoli",
      indoorStartWeeks: [8, 6],
      transplantWeeks: [-2, 0],
      directSowWeeks: null,
      notes: "Cool-season. Likes consistent moisture and cool temps."
    },
    {
      id: "cabbage",
      name: "Cabbage",
      indoorStartWeeks: [8, 6],
      transplantWeeks: [-2, 0],
      directSowWeeks: null,
      notes: "Cool-season. Transplant while weather is still cool."
    }
  ];

  // ---- Helpers ----
  const byId = (id) => document.getElementById(id);

  // Exportable plan rows (built during calculate)
  let PLAN_ROWS = [];
  let CURRENT_CROP = "";

  function stripHtml(html) {
    const tmp = document.createElement("div");
    tmp.innerHTML = html || "";
    return (tmp.textContent || "").replace(/\s+/g, " ").trim();
  }


  // Site crop metadata (slug, etc.) from Eleventy data. Used for linking.
  const SITE_CROPS = (() => {
    try {
      const el = document.getElementById("siteCropsJson");
      if (!el) return [];
      return JSON.parse(el.textContent || "[]");
    } catch (e) {
      return [];
    }
  })();

  const SITE_CROPS_BY_ID = Object.create(null);
  for (const c of SITE_CROPS) {
    if (c && c.id) SITE_CROPS_BY_ID[c.id] = c;
  }

  // Tool crop IDs don't always match site crop IDs (e.g., tomato ‚Üí tomatoes).
  const CROP_ID_ALIASES = {
    tomato: "tomatoes",
    pepper: "peppers",
  };

function cropIcon(id) {
  const icons = {
    tomato: "üçÖ",
    pepper: "ü´ë",
    cucumber: "ü•í",
    zucchini: "ü•í",      // no zucchini emoji; cucumber is closest
    bean: "ü´ò",
    lettuce: "ü•¨",
    spinach: "üçÉ",       // no spinach emoji; leafy greens works
    kale: "ü•¨",
    broccoli: "ü•¶",
    cabbage: "ü•¨"
  };

  return icons[id] || "üå±";
}


  function cropUrl(cropId) {
    const normalizedId = CROP_ID_ALIASES[cropId] || cropId;
    const meta = SITE_CROPS_BY_ID[normalizedId];
    const slug = meta && meta.slug ? meta.slug : normalizedId;
    return `/crops/${slug}/`;
  }

  function toDate(inputValue) {
    if (!inputValue) return null;
    const [y, m, d] = inputValue.split("-").map(Number);
    return new Date(y, m - 1, d, 12, 0, 0, 0); // local noon to reduce DST weirdness
  }

  function fmt(date) {
    return date.toLocaleDateString(undefined, { year: "numeric", month: "short", day: "numeric" });
  }

  function addDays(date, days) {
    const out = new Date(date);
    out.setDate(out.getDate() + days);
    return out;
  }

  function weeksToDays(weeks) { return Math.round(weeks * 7); }

  function windowFromWeeks(anchorDate, earlierWeeks, laterWeeks, protectionDays) {
    const start = addDays(anchorDate, -weeksToDays(earlierWeeks));
    const end   = addDays(anchorDate, -weeksToDays(laterWeeks));
    return [start, end].map(d => addDays(d, -protectionDays));
  }

  function windowFromWeeksRelative(anchorDate, earlierWeeks, laterWeeks, protectionDays) {
    const start = addDays(anchorDate, weeksToDays(earlierWeeks));
    const end   = addDays(anchorDate, weeksToDays(laterWeeks));
    return [start, end].map(d => addDays(d, -protectionDays));
  }

  function addRow(task, windowText, notes) {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td><strong>${task}</strong></td>
      <td>${windowText}</td>
      <td class="muted">${notes || ""}</td>
    `;
    byId("resultsBody").appendChild(tr);

    // Build export rows (skip the decorative Crop header row; crop is already a column)
    if (task !== "Crop") {
      PLAN_ROWS.push({
        crop: CURRENT_CROP,
        task: stripHtml(task),
        window: stripHtml(windowText),
        notes: stripHtml(notes || "")
      });
    }
  }

  // ---- Init UI ----
function initCropSelect() {
  const sel = byId("crop");
  sel.innerHTML = "";

  // Sort crops alphabetically by name (without mutating original array)
  const sortedCrops = [...CROPS].sort((a, b) =>
    a.name.localeCompare(b.name, undefined, { sensitivity: "base" })
  );

  for (const c of sortedCrops) {
    const opt = document.createElement("option");
    opt.value = c.id;
    opt.textContent = c.name;
    sel.appendChild(opt);
  }
}

initCropSelect();

  // ---- Main calculate ----
  function calculate() {
    byId("warnBox").style.display = "none";
    byId("resultsCard").style.display = "none";
    byId("resultsBody").innerHTML = "";
    PLAN_ROWS = [];
    byId("printBtn").style.display = "none";
    byId("copyBtn").style.display = "none";
    byId("csvBtn").style.display = "none";
    byId("txtBtn").style.display = "none";
    byId("copyBtn").style.display = "none";
    byId("csvBtn").style.display = "none";
    byId("txtBtn").style.display = "none";

    const frost = toDate(byId("lastFrost").value);
    const protectionDays = parseInt(byId("protection").value, 10) || 0;
    const cropId = byId("crop").value;
    const crop = CROPS.find(c => c.id === cropId);

    if (!frost) {
      byId("warnBox").style.display = "block";
      byId("warnBox").innerHTML = "Please enter an average <strong>last frost date</strong> to calculate your windows.";
      return;
    }

    // Crop page
addRow(
  "Crop",
  `<a href="${cropUrl(crop.id)}">${crop.name}</a>`,
  `<span class="noteIcon" title="${crop.name}" aria-label="${crop.name} icon">${cropIcon(crop.id)}</span>`
);


    // Indoor start window (not shifted by protection)
    if (crop.indoorStartWeeks) {
      const [earlier, later] = crop.indoorStartWeeks;
      const [start, end] = windowFromWeeks(frost, earlier, later, 0);
      addRow("Start seeds indoors", `${fmt(start)} ‚Äì ${fmt(end)}`, crop.notes);
    } else {
      addRow("Start seeds indoors", "Not typically recommended", crop.notes);
    }

    // Transplant window (shifted earlier by protection)
    if (crop.transplantWeeks) {
      const [earlier, later] = crop.transplantWeeks;
      const [start, end] = windowFromWeeksRelative(frost, earlier, later, protectionDays);
      const hardenStart = addDays(start, -10);
      const hardenEnd = addDays(start, -7);
      addRow("Begin hardening off", `${fmt(hardenStart)} ‚Äì ${fmt(hardenEnd)}`, "Start gradual outdoor exposure ~7‚Äì10 days before transplanting.");
      addRow("Transplant outdoors", `${fmt(start)} ‚Äì ${fmt(end)}`, protectionDays ? "Shifted earlier due to season protection." : "Open-garden timing.");
    } else {
      addRow("Transplant outdoors", "Not applicable", "");
    }

    // Direct sow window (shifted earlier by protection)
    if (crop.directSowWeeks) {
      const [earlier, later] = crop.directSowWeeks;
      const [start, end] = windowFromWeeksRelative(frost, earlier, later, protectionDays);
      addRow("Direct sow outdoors", `${fmt(start)} ‚Äì ${fmt(end)}`, protectionDays ? "Shifted earlier due to season protection." : "");
    } else {
      addRow("Direct sow outdoors", "Not typical for this crop", "");
    }

    // Confidence note
    byId("resultsCard").style.display = "block";
    byId("printBtn").style.display = "inline-block";
    byId("copyBtn").style.display = "inline-block";
    byId("csvBtn").style.display = "inline-block";
    byId("txtBtn").style.display = "inline-block";
  }

  function resetForm() {
    byId("lastFrost").value = "";
    byId("protection").value = "0";
    for (const opt of byId("crop").options) opt.selected = false;
    // Select the first option for a sensible default
    if (byId("crop").options.length) byId("crop").options[0].selected = true;
    byId("warnBox").style.display = "none";
    byId("resultsCard").style.display = "none";
    byId("resultsBody").innerHTML = "";
    byId("printBtn").style.display = "none";
    byId("copyBtn").style.display = "none";
    byId("csvBtn").style.display = "none";
    byId("txtBtn").style.display = "none";
  }


  // ---- Export helpers ----
  function planToCSV(rows) {
    const esc = (v) => {
      const s = String(v ?? "");
      // Escape quotes and wrap fields that contain commas/newlines/quotes
      const needs = /[",\n\r]/.test(s);
      const out = s.replace(/"/g, '""');
      return needs ? `"${out}"` : out;
    };
    const header = ["Crop", "Task", "Window", "Notes"];
    const lines = [header.map(esc).join(",")];
    for (const r of rows) {
      lines.push([r.crop, r.task, r.window, r.notes].map(esc).join(","));
    }
    return lines.join("\n");
  }

  function planToText(rows) {
    // Group by crop, keep original order
    const groups = new Map();
    for (const r of rows) {
      if (!groups.has(r.crop)) groups.set(r.crop, []);
      groups.get(r.crop).push(r);
    }

    const out = [];
    out.push("GrowByDate.com ‚Äî Seed Starting Plan");
    const frostVal = byId("lastFrost").value ? fmt(toDate(byId("lastFrost").value)) : "";
    const prot = parseInt(byId("protection").value, 10) || 0;
    if (frostVal) out.push(`Last frost (average): ${frostVal}`);
    out.push(`Season extension (days): ${prot}`);
    out.push("");
    out.push("Freeze damage can begin at 32¬∞F / 0¬∞C.");
    out.push("");

    for (const [crop, items] of groups.entries()) {
      out.push(crop);
      out.push("-".repeat(Math.min(60, crop.length)));
      for (const r of items) {
        out.push(`‚Ä¢ ${r.task}: ${r.window}${r.notes ? " ‚Äî " + r.notes : ""}`);
      }
      out.push("");
    }
    return out.join("\n");
  }

  function downloadFile(filename, content, mime) {
    const blob = new Blob([content], { type: mime });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  }

  async function copyPlan() {
    const txt = planToText(PLAN_ROWS);
    try {
      await navigator.clipboard.writeText(txt);
      byId("copyBtn").textContent = "Copied!";
      setTimeout(() => (byId("copyBtn").textContent = "Copy plan"), 1200);
    } catch (e) {
      // Fallback: prompt (still lightweight)
      window.prompt("Copy your plan:", txt);
    }
  }

  function downloadCSV() {
    const csv = planToCSV(PLAN_ROWS);
    const stamp = byId("lastFrost").value || "plan";
    downloadFile(`seed-start-plan-${stamp}.csv`, csv, "text/csv;charset=utf-8");
  }

  function downloadText() {
    const txt = planToText(PLAN_ROWS);
    const stamp = byId("lastFrost").value || "plan";
    downloadFile(`seed-start-plan-${stamp}.txt`, txt, "text/plain;charset=utf-8");
  }


  function printResults() {
    window.print();
  }

  byId("calcBtn").addEventListener("click", calculate);
  byId("resetBtn").addEventListener("click", resetForm);
  byId("printBtn").addEventListener("click", printResults);
  byId("copyBtn").addEventListener("click", copyPlan);
  byId("csvBtn").addEventListener("click", downloadCSV);
  byId("txtBtn").addEventListener("click", downloadText);
</script>